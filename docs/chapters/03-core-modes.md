# 第3章：Cursor Chat 深度應用 - 掌握PM的程式碼分析利器

## 學習目標

完成本章節後，您將能夠：
- 熟練運用 Cursor Chat 進行專業級程式碼分析
- 掌握四大分析模式的實戰應用技巧
- 學會根據不同PM任務選擇適當的分析策略
- 運用九大分析模板產出商業導向的技術報告
- 建立系統性的程式碼分析工作流程

## 課前準備

- 完成第1-2章的學習，熟悉Cursor基本操作和上下文機制
- 下載並用Cursor開啟 [Cloudy微服務專案](https://github.com/spyua/cloudy_homework)
- 準備好筆記工具，記錄分析發現和商業洞察

---

## 3.1 Chat 進階設定與分析準備 (15分鐘)

### 🚀 從基礎Chat到專業分析工具

在第1章我們學會了 Cursor Chat 的基本操作，第2章理解了上下文機制的威力。現在，我們要將這些基礎能力升級為**專業級的程式碼分析工具**。

#### 3.1.1 專業分析的三大要素

**1. 結構化的提問方式**
- 明確角色身份（我是產品經理...）
- 指定分析範圍（@檔案、#函數、整個專案）
- 要求商業語言輸出（避免純技術術語）

**2. 系統化的分析流程**
- 先整體後局部：架構→組件→功能→細節
- 商業價值導向：功能→影響→風險→建議
- 可追蹤的分析記錄：問題→發現→結論→行動

**3. 標準化的輸出格式**
- 執行摘要（30秒內看懂核心）
- 商業影響分析（對產品的實際意義）
- 行動建議（PM可以立即執行的下一步）

#### 3.1.2 Cloudy專案快速導覽

讓我們先用Chat快速了解我們的實戰專案：

**💡 實戰練習 3.1-A：專案概覽分析**

在Cursor Chat中輸入：
```
我是一位產品經理，剛接手Cloudy專案。請幫我用產品經理能理解的語言，分析 @README.md 的內容，告訴我：

1. 這個專案的核心商業價值是什麼？
2. 主要包含哪些功能模組？
3. 目標用戶可能是誰？
4. 技術架構對產品發展有什麼限制和優勢？

請用結構化的方式回答，避免過多技術細節。
```

**期待收穫：**
- 30秒內掌握Cloudy專案的商業定位
- 理解微服務架構對產品的影響
- 建立後續深度分析的基礎認知

---

## 3.2 四大分析模式實戰演練 (50分鐘)

### 🎯 為什麼需要分析模式？

每個PM任務都有其特定的分析目標和輸出需求。我們設計了四種專業分析模式，每種模式都有：
- **明確的使用時機**：什麼情況下用這個模式？
- **標準化的提問框架**：如何問出有價值的問題？
- **結構化的輸出格式**：如何獲得可行動的分析結果？

---

### 3.2.1 架構分析模式 - 系統全貌掌握 (15分鐘)

**使用時機：**
- 新專案接手時的快速了解
- 向高層報告系統架構
- 評估系統重構的可行性
- 技術選型的影響評估

#### 🔧 專業提問框架

**基礎架構分析：**
```
【架構分析請求】我是產品經理，需要向管理層報告系統架構。

請用資深技術架構師的角度分析 @cloudy-account 模組，並用產品經理能理解的語言提供：

1. 系統概覽 - 這個模組的核心商業功能是什麼？
2. 核心組件與職責 - 主要包含哪些組件，各自負責什麼？
3. 關鍵數據流 - 用戶註冊/登入時數據是如何流動的？
4. 外部依賴 - 依賴哪些外部服務，有什麼風險？
5. 產品層級總結 - 對未來產品發展有什麼影響？

請確保技術說明都能轉化為商業語言。
```

**💡 實戰練習 3.2.1-A：Cloudy帳戶模組分析**

執行上述提問框架，觀察輸出格式是否包含：
- ✅ 商業功能說明（而非技術實作）
- ✅ 組件職責的產品影響
- ✅ 數據流的用戶體驗描述
- ✅ 依賴風險的商業評估
- ✅ 可行動的產品建議

#### 🎯 進階分析技巧

**跨模組關係分析：**
```
請分析 cloudy-account 和 cloudy-security 模組的依賴關係，說明：

1. 為什麼需要分離這兩個模組？
2. 這種設計對產品安全性有什麼好處？
3. 如果要新增第三方登入（如Google、Facebook），會影響哪些模組？
4. 這種架構對團隊開發效率有什麼影響？
```

**輸出範例（期待格式）：**
```
## 系統概覽
cloudy-account是用戶身份管理的核心模組，負責處理用戶註冊、登入等身份相關業務...

## 核心組件與職責
- UserVerifyController: 處理用戶註冊和登入的API請求
- 相關業務邏輯服務: 驗證用戶身份並生成認證令牌
...

## 產品層級總結
這是典型的微服務設計，有利於功能獨立開發，但需要額外關注模組間的協調...
```

---

### 3.2.2 功能解讀模式 - 程式碼商業價值轉譯 (12分鐘)

**使用時機：**
- 向業務方解釋特定功能
- 撰寫產品規格書時需要技術細節
- 評估功能變更的商業影響
- 準備技術評審會議

#### 🔧 專業提問框架

```
【程式碼功能解讀請求】我是產品經理，需要向業務團隊解釋具體功能。

請用專家級技術文件撰寫員的角度分析以下程式碼：
@src/main/java/com/ck/account/controller/UserVerifyController.java

分析要求：
1. 用商業語言解釋這個Controller的核心目的
2. 提供簡單的日常生活類比來說明其功能
3. 說明API輸入和輸出的商業意義
4. 識別潛在的業務規則或限制條件
5. 評估對用戶體驗的影響

目標讀者：非技術背景的業務團隊成員
```

**💡 實戰練習 3.2.2-A：登入功能深度解讀**

執行上述分析，並觀察是否獲得：
- ✅ 功能的商業目的清晰說明
- ✅ 生活化類比（如：像門禁卡驗證系統）
- ✅ 輸入輸出的業務意義
- ✅ 隱含的業務規則識別
- ✅ 用戶體驗影響評估

#### 🎯 進階功能分析

**API商業邏輯分析：**
```
請深入分析 /login API 的完整業務流程：

1. 用戶輸入帳密後，系統執行了哪些商業邏輯驗證？
2. JWT Token的設計對用戶體驗有什麼影響？
3. 登入失敗時的錯誤處理，如何影響用戶感受？
4. 這個登入機制與常見的社群登入（如Google登入）相比有什麼優劣？
5. 如果要支援多裝置同時登入，現有設計需要什麼調整？
```

**期待輸出格式：**
- 功能目的的商業描述
- 生活化類比說明
- 輸入輸出的業務意義
- 業務規則和限制
- 用戶體驗影響評估

---

### 3.2.3 開發規劃模式 - 新功能成本評估 (12分鐘)

**使用時機：**
- Sprint規劃會議前的準備
- 新功能優先級排序決策
- 向管理層報告開發成本
- 評估技術實現可行性

#### 🔧 專業提問框架

```
【功能開發規劃請求】我是產品經理，需要評估新功能的開發成本。

請用產品與工程策略師的角度分析以下開發需求：

新功能需求：在現有Cloudy系統中新增「用戶設定檔管理」功能，包括：
- 用戶可以上傳大頭照
- 修改個人資訊（姓名、電話、地址）
- 設定隱私偏好
- 查看帳戶活動紀錄

現有程式碼基礎：@cloudy-account 和 @cloudy-files 模組

規劃要求：
1. 功能實作的技術路徑分析
2. 需要修改的現有組件清單
3. 開發複雜度評估（簡單/中等/複雜）
4. 潛在技術風險與緩解策略
5. 預估工期與資源需求（以人週為單位）

商業考量：預算有限，希望儘快上線增加用戶黏著度
```

**💡 實戰練習 3.2.3-A：用戶設定檔功能規劃**

執行分析並評估：
- ✅ 技術實現路徑的可行性
- ✅ 影響範圍的完整性
- ✅ 複雜度評估的準確性
- ✅ 風險識別的全面性
- ✅ 資源估算的合理性

#### 🎯 進階規劃技巧

**多方案比較分析：**
```
針對用戶設定檔功能，請比較三種實現方案：

方案A：在cloudy-account模組內擴展
方案B：創建新的cloudy-profile模組
方案C：使用第三方用戶管理服務（如Auth0）

請從以下角度比較：
1. 開發時程差異
2. 維護成本考量
3. 系統架構影響
4. 未來擴展性
5. 商業風險評估

並給出明確的方案推薦和理由。
```

---

### 3.2.4 品質評估模式 - 技術債商業影響分析 (11分鐘)

**使用時機：**
- 季度技術債審查
- 系統效能問題排查
- 新人加入團隊前的程式碼清理
- 預防性風險管理

#### 🔧 專業提問框架

```
【程式碼品質評估請求】我是產品經理，擔心技術債會影響產品發展速度。

請用程式碼品質與可維護性專家的角度檢查：
@cloudy-files 模組的整體程式碼品質

評估重點：技術債與維護性風險

分析要求：
1. 識別主要的技術債類型及其商業影響
2. 評估對未來開發速度的具體影響
3. 計算延遲處理技術債的商業成本
4. 提供重構建議的優先級排序
5. 估算重構所需的時間與資源

商業情境：
- 團隊規模：3位開發者
- 近期計劃：6個月內要新增5個檔案相關功能
- 關注重點：系統穩定性和開發效率
```

**💡 實戰練習 3.2.4-A：檔案模組品質評估**

執行分析並關注：
- ✅ 技術債的商業風險量化
- ✅ 對開發速度影響的具體評估
- ✅ 商業成本的合理估算
- ✅ 優先級排序的決策依據
- ✅ 可執行的改進建議

#### 🎯 進階品質分析

**效能影響商業評估：**
```
請特別關注檔案上傳功能的效能表現：

1. 目前的檔案上傳流程有哪些效能瓶頸？
2. 如果用戶同時上傳大量檔案會如何影響系統？
3. 這些效能問題對用戶體驗有什麼具體影響？
4. 修復這些問題需要多少開發資源？
5. 不修復的話，對業務增長有什麼風險？

請量化影響並提供明確的商業建議。
```

---

## 3.3 九大分析模板的靈活運用 (20分鐘)

### 🎪 分析模板的戰略價值

四大分析模式為我們提供了基本框架，但真實的PM工作往往需要更細緻的分析角度。九大分析模板就像是**專業分析師的工具箱**，每個工具都針對特定的分析需求。

#### 3.3.1 自動觸發模板 - 始終關注的核心要素

這三個模板會在任何分析中自動應用，確保不遺漏關鍵商業資訊：

**🔄 API分析模板 (api_analysis)**
- **自動觸發**：每當分析API相關程式碼
- **核心價值**：將技術API轉譯為商業功能描述
- **PM關注點**：功能邊界、輸入輸出、錯誤處理的用戶影響

**🔄 使用案例映射 (use_case_mapping)**  
- **自動觸發**：分析任何功能性程式碼
- **核心價值**：建立程式碼與用戶情境的對應關係
- **PM關注點**：Who、When、Why、How的完整用戶故事

**🔄 數據流追蹤 (data_flow_tracing)**
- **自動觸發**：涉及多個組件的功能分析
- **核心價值**：理解資訊如何在系統中流動
- **PM關注點**：用戶操作到系統回應的完整路徑

#### 3.3.2 條件觸發模板 - 特定情境的深度分析

**💡 實戰練習 3.3.2-A：綜合模板應用**

讓我們通過一個完整的分析來體驗多模板協作：

```
【綜合分析請求】我需要全面了解Cloudy系統的檔案上傳功能，準備向董事會報告。

請分析 @cloudy-files/src/main/java/com/ck/file/controller/FilePorcessController.java 中的上傳功能，並自動應用相關分析模板：

1. API分析：上傳功能的商業價值和技術邊界
2. 使用案例映射：誰在什麼情況下會使用這個功能？
3. 數據流追蹤：從用戶選擇檔案到儲存完成的完整流程
4. 錯誤處理：如果上傳失敗，用戶會看到什麼？
5. 效能分析：大檔案上傳對系統有什麼影響？
6. 安全評估：檔案上傳有哪些安全風險需要關注？

請用董事會能理解的商業語言，並量化所有風險和影響。
```

#### 3.3.3 特殊模板的策略應用

**🛡️ 安全認證分析 (security_auth)**
```
針對用戶登入功能，請評估：
1. 認證流程是否符合業界標準？
2. JWT Token的安全設計是否足夠？
3. 密碼處理是否符合資料保護法規？
4. 有哪些安全風險可能影響用戶信任？

從產品經理角度，我需要知道這些安全措施對用戶體驗和法規合規的影響。
```

**⚡ 效能監控分析 (performance_watch)**
```
檔案上傳功能的效能分析：
1. 目前系統能承受多少並發上傳？
2. 大檔案上傳時用戶需要等待多久？
3. 效能瓶頸在哪裡，如何影響用戶體驗？
4. 改善效能需要多少投資？
5. 不改善的話對業務增長有什麼風險？
```

**📋 版本治理分析 (versioning_governance)**
```
我們計劃修改API結構，請評估：
1. 如何確保不影響現有客戶？
2. 版本升級策略應該如何設計？
3. 舊版本何時可以安全下線？
4. 這些變更對客戶關係有什麼影響？
```

### 🎯 模板組合的最佳實踐

**情境A：新功能評估**
```
組合使用：planner-system + use_case_mapping + performance_watch + security_auth
目的：全面評估新功能的開發成本、用戶價值、效能影響和安全風險
```

**情境B：系統重構決策**
```
組合使用：analyzer-system + refactorer-system + data_flow_tracing + versioning_governance  
目的：理解現有架構、識別技術債、評估重構影響、規劃變更策略
```

**情境C：客戶技術展示準備**
```
組合使用：documenter-system + api_analysis + test_stub_generator
目的：準備清晰的功能說明、API展示和客戶試用資料
```

---

## 3.4 綜合實戰：完整專案分析流程 (5分鐘)

### 🚀 端到端分析演示

讓我們通過一個完整的實戰場景，整合所有學到的技能：

**📋 場景設定：**
- **角色**：你是新加入的PM，負責Cloudy產品的後續發展
- **任務**：30分鐘內向CEO報告產品現況和發展建議
- **目標**：產出專業的產品分析報告

**🎯 分析流程：**

**Step 1：系統架構概覽 (8分鐘)**
```
使用 analyzer-system.prompt 分析整個 @tutorial-sample-project

我是新任產品經理，需要向CEO報告Cloudy產品現況。請提供：
1. 產品的核心商業價值和定位
2. 主要功能模組及其市場意義  
3. 技術架構的競爭優勢和限制
4. 與競品相比的技術差異化
5. 產品發展的技術瓶頸和機會

請用CEO能理解的商業語言，並提供可行動的戰略建議。
```

**Step 2：核心功能深度分析 (12分鐘)**
```
使用 documenter-system.prompt + 多模板組合

分析核心業務流程：
1. 用戶註冊登入流程 (@cloudy-account)
2. 檔案管理功能 (@cloudy-files)  
3. 安全認證機制 (@cloudy-security)

每個功能都要回答：
- 商業價值是什麼？
- 用戶體驗如何？
- 有什麼風險需要關注？
- 改進建議是什麼？
```

**Step 3：產品發展規劃 (10分鐘)**
```
使用 planner-system.prompt + refactorer-system.prompt

基於分析結果，規劃產品路線圖：
1. 短期(3個月)：應該優先改善什麼？
2. 中期(6個月)：可以新增哪些功能？
3. 長期(1年)：技術架構需要什麼演進？
4. 每個階段的投資回報評估
5. 主要風險和緩解策略
```

**🎯 期待產出：CEO報告範本**
```
## Cloudy產品現況分析報告

### 執行摘要
- 產品定位：[一句話說明核心價值]
- 技術優勢：[主要差異化]
- 關鍵風險：[需要立即關注的問題]
- 建議行動：[下個月要做什麼]

### 產品功能分析
[每個核心功能的商業價值和改進建議]

### 技術架構評估  
[架構優勢、限制和演進建議]

### 產品路線圖
[短中長期發展規劃和投資建議]

### 風險管理
[技術債、安全風險、效能瓶頸的商業影響和緩解策略]
```

---

## 🎯 本章核心技能檢核表

完成本章學習後，您應該能夠：

### ✅ Chat分析基礎能力
- [ ] 能夠設計結構化的分析提問
- [ ] 理解不同分析模式的適用時機
- [ ] 掌握商業導向的輸出格式要求

### ✅ 四大分析模式運用
- [ ] **架構分析**：快速掌握系統全貌和商業影響
- [ ] **功能解讀**：將程式碼轉譯為商業功能描述
- [ ] **開發規劃**：評估新功能的成本和風險
- [ ] **品質評估**：識別技術債的商業影響

### ✅ 分析模板靈活應用
- [ ] 理解九大模板的觸發時機和應用場景
- [ ] 能夠組合多個模板進行綜合分析
- [ ] 掌握模板輸出的商業價值提取

### ✅ 實戰分析能力
- [ ] 能在30分鐘內完成專案概覽分析
- [ ] 具備向非技術團隊解釋技術功能的能力
- [ ] 能夠產出可行動的商業建議和風險評估

---

## 💡 實作練習

### 練習1：模式選擇判斷 (20分鐘) ⭐⭐
**目標：** 根據PM任務選擇正確的分析模式

**任務情境：**
1. "CEO要求評估是否要重寫整個檔案系統" → 應用哪種模式？
2. "業務方想知道登入功能到底是怎麼運作的" → 應用哪種模式？
3. "客戶要求新增批次檔案上傳功能" → 應用哪種模式？
4. "系統最近變慢了，需要找出效能問題" → 應用哪種模式？

**評估標準：**
- 正確識別分析模式 (40%)
- 提問框架設計合理 (30%)
- 預期輸出格式清晰 (30%)

### 練習2：Cloudy專案綜合分析 (30分鐘) ⭐⭐⭐
**目標：** 完整應用四大分析模式

**任務：** 假設你要向投資人介紹Cloudy產品的技術競爭力

**要求：**
1. 使用架構分析模式梳理技術優勢
2. 使用功能解讀模式解釋核心功能
3. 使用規劃模式評估發展潛力
4. 使用品質評估模式識別風險

**產出：** 5分鐘的投資人簡報要點

### 練習3：模板組合實戰 (25分鐘) ⭐⭐⭐⭐
**目標：** 靈活運用多模板組合分析

**情境：** 競品推出了類似的檔案管理功能，你需要分析我們的競爭位置

**分析要求：**
- 功能對比分析
- 技術架構優劣評估
- 用戶體驗差異識別
- 改進建議和優先級

**成功標準：**
- 分析全面且有深度 (25%)
- 商業洞察清晰可行動 (25%)
- 風險評估量化準確 (25%)
- 改進建議具體可執行 (25%)

---

## 🚨 常見錯誤與避免方法

### ❌ 錯誤1：提問過於技術化
**問題：** "請分析這個Spring Boot Controller的@Autowired注入機制"
**改進：** "請分析用戶登入功能的核心商業邏輯和風險"

### ❌ 錯誤2：忽視商業語言轉譯
**問題：** 接受純技術術語的回答
**改進：** 明確要求"用產品經理能理解的語言"

### ❌ 錯誤3：分析範圍過於狹窄
**問題：** 只看單一檔案，忽視系統關聯
**改進：** 使用上下文引用，關注組件間關係

### ❌ 錯誤4：缺乏行動導向
**問題：** 只要分析結果，不要建議
**改進：** 明確要求可執行的下一步行動

---

## 🎓 進階學習資源

### 📚 延伸閱讀
- [AI 模式深度解析](/resources/ai-modes) - 了解更多分析技巧
- [Cursor 使用指南](/resources/cursor-guide) - 進階操作技巧
- [系統提示模板庫](/resources/prompts) - 更多專業提示範例

### 🔗 相關章節
- [第2章：理解上下文](/chapters/02-understanding-context) - 深化上下文運用
- [第4章：AI模型選擇](/chapters/04-model-selection) - 選擇最適合的分析模型
- [第6章：專案準備](/chapters/06-project-preparation) - 建立標準分析流程

### 🛠️ 實用工具
- [Cloudy專案完整範例](https://github.com/spyua/cloudy_homework)
- [分析模板快速參考](/resources/prompts)
- [PM技術溝通話術庫](/resources/context-guide)

---

## 📝 本章總結

第3章讓我們從Cursor Chat的基礎使用者，進化為**專業的程式碼分析師**。我們掌握了：

### 🎯 **四大核心能力**
1. **系統思維**：能夠快速掌握複雜系統的商業邏輯
2. **溝通轉譯**：將技術複雜性轉化為商業決策依據  
3. **風險意識**：識別技術選擇對產品發展的影響
4. **行動導向**：每次分析都產出可執行的改進建議

### 🚀 **實戰價值**
- **時間效率**：30分鐘內完成專業級程式碼分析
- **決策支援**：為產品決策提供可靠的技術評估
- **團隊協作**：與開發團隊進行高品質的技術討論
- **競爭優勢**：基於技術理解做出更明智的產品策略

下一章，我們將學習**AI模型選擇**，了解如何根據不同的分析任務選擇最適合的AI模型，進一步提升分析的準確性和效率。

---

*💡 **學習提醒**：程式碼分析是一項需要持續練習的技能。建議每週至少用本章的方法分析一個新專案，逐步建立你的專業直覺和分析速度。*