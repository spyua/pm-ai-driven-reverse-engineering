*Cursor AI 助理 (Agent) 功能詳解**

### **學習目標**

完成本單元後，您將能夠：
* 理解 Agent 的核心功能與用途。
* 掌握啟動 Agent 並與其互動的基本方法。
* 區分 Agent、Ask、Manual 等不同模式的適用場景。
* 學習如何透過 `@` 符號提供精準的上下文以獲得更好的 AI 回應。
* 熟悉審查 (Review)、套用 (Apply) 和管理 AI 所做程式碼變更的完整流程。
* 了解如何利用頁籤、檢查點、模型選擇等進階功能提升工作效率。

---

### **第一部分：Agent 核心概念**

#### **什麼是 Agent？**

Agent 是 Cursor 內建在側邊欄的 AI 助理，它具備完整的**程式碼庫感知能力 (codebase-aware)**。您可以透過自然語言與它對話，讓它協助您完成以下任務，而無需離開編輯器：

* **提出問題**：對不熟悉的程式碼尋求解釋。
* **請求編輯**：要求 AI 進行程式碼修改。
* **產生指令**：取得終端機 (Terminal) 指令建議。
* **自動化工作流程**：讓 AI 自動搜尋、推理並執行一系列開發任務。

#### **核心能力一覽**

* **理解程式碼**：快速解釋、分析或探索您的整個專案。
* **編輯程式碼**：從微小的語法調整到跨多個檔案的大型重構。
* **執行指令**：根據您的需求，建議適合的終端機指令。
* **自動化工作**：讓 AI 規劃並執行複雜的工作流程，例如建立新功能或設定專案。

---

### **第二部分：快速入門**

#### **如何啟動 Agent**

* **Mac**: 按下 `⌘ + L`
* **Windows/Linux**: 按下 `Ctrl + L`

按下快捷鍵後，側邊欄會開啟 Agent 對話視窗。直接用自然語言輸入您的請求即可。

#### **我可以用 Agent 做什麼？**

Agent 擅長處理複雜且需要上下文的任務，例如：
* **開發新功能**：”請幫我新增一個使用者登出按鈕，並處理相關的 API 請求與狀態更新。“
* **重構程式碼**：”請將這個檔案中的函式重構為一個可複用的 React Hook。“
* **建立新專案**：”請幫我初始化一個使用 TypeScript 和 Vite 的 React 新專案，並設定好 ESLint。“

---

### **第三部分：核心功能詳解**

#### **1. Agent 模式 (Modes)**

Agent 提供多種針對不同任務優化的模式，您可以使用 `⌘ + .` 快捷鍵或點擊模式選擇器來切換。

| 模式 | 主要用途 | 特點 |
| :--- | :--- | :--- |
| **Agent** | **全權委託模式** | 允許 AI **自主學習**您的專案，並代表您進行**跨檔案**的大範圍程式碼變更。適合大型、複雜的任務。 |
| **Ask** | **問答與規劃模式** | 向 AI 提問、獲取程式碼解釋、規劃功能。AI 提出的程式碼變更**需要您手動點擊 "Apply"** 才會生效。 |
| **Manual** | **精準編輯模式** | 進行焦點明確的編輯。AI **只會使用您明確提供**的上下文（例如您圈選的程式碼），不會自主探索其他檔案。 |
| **Custom** | **自訂模式** | 您可以建立符合自己特定工作流程的模式，例如設定一個專門用於「撰寫測試」的模式。 |

#### **2. 提供精準的上下文 (Context)**

Agent 的回應品質取決於您提供的上下文。它會自動分析：
* **當前開啟的檔案**：您正在查看的程式碼。
* **專案結構**：檔案的組織方式與依賴關係。

**最重要的技巧**：使用 ` @ ` 符號來引用特定的程式碼元素，例如：
* `@檔案名.tsx`：引用特定檔案。
* `@函式名`：引用某個函式或變數。
* `@資料夾名/`：引用整個資料夾。

介面會根據您的提問，智慧地建議相關的上下文，確保 AI 能準確理解您的意圖。

#### **3. 審查與套用程式碼變更**

當 Agent 建議程式碼變更時：
1.  **審查 (Review)**：變更會以差異比對 (diff view) 的形式呈現，讓您清楚看到修改前後的差別。
2.  **套用 (Apply)**：在 `Ask` 模式下，您需要明確點擊 **"Apply"** 按鈕，變更才會被寫入檔案。
3.  **接受/拒絕 (Accept/Reject)**：在變更被寫入檔案後，您可以決定保留或捨棄這些變更。

> **小提示**：Cursor 使用了客製化訓練的模型，即使是數千行的大型檔案，也能在幾秒鐘內快速套用變更。

---

### **第四部分：進階功能與技巧**

* **頁籤 (Tabs)**
    * **用途**：同時進行多個獨立的對話。
    * **操作**：按下 `⌘ + T` (Mac) 或 `Ctrl + T` (Win/Linux) 建立新頁籤。
    * **優點**：頁籤之間可以並行處理，不會互相干擾。Cursor 會智慧地管理，避免多個頁籤同時修改同一個檔案。

* **檢查點 (Checkpoints)**
    * **用途**：隨時將您的專案還原到過去的某個狀態。
    * **機制**：每次您提出請求或 AI 進行修改時，Cursor 都會自動建立一個程式碼庫的快照（檢查點）。
    * **操作**：在對話歷史中，找到過去的訊息，點擊輸入框中出現的 **"Restore Checkpoint"** 按鈕即可還原。

* **模型選擇 (Model Selection)**
    * **預設**：預設為 "auto-select"，會自動為您的請求選擇最適合的高階模型。
    * **手動**：您也可以從模型選擇器中手動指定要使用的 AI 模型，以進行更精細的控制。

* **歷史紀錄、成本與審查**
    * **歷史紀錄**：已移至命令面板 (`⌘+Shift+P`)，搜尋 "Show Chat History"。
    * **成本檢視**：在歷史紀錄中，您可以點擊圖示查看基於用量計價模型的成本明細。
    * **變更審查**：在對話結束時，點擊 **"Review changes"** 按鈕，可以一次性查看該次對話中所有的程式碼變更。

* **管理與協作**
    * **匯出對話 (Exporting)**：將完整的對話（包含程式碼區塊與上下文）匯出為 Markdown 檔案，方便分享、記錄或存檔。
    * **複製對話 (Duplicating)**：在任一則訊息的選單中，可以從該點開始一個新的分支對話，方便您在不影響原對話的情況下，探索不同的解決方案。

---

### **FAQ / 常見問題**

* **Q: Agent (編輯器) 介面去哪了？**
    * A: 在舊版中，「Chat」(唯讀) 和「Agent」(手動編輯) 是分開的。現在，這兩個概念已與新的 Agent 模式合併為一個統一的「Agent」介面，功能更強大。過去的 `Ask` 模式類似於舊的 Chat，而 `Manual` 模式則對應舊的 Agent。

* **Q: Agent 處理完成後可以有通知嗎？**
    * A: 可以。請至 `Settings → Features → Chat → Play sound on finish` 開啟聲音通知 (此為 Beta 功能)。

* **Q: 我的對話紀錄會同步到其他電腦嗎？**
    * A: 不會。對話紀錄是儲存在本機電腦上，不會與您的 Cursor 帳戶綁定。

* **Q: 如何更改預設的 Agent 模式？**
    * A: 請至 `Settings → Features → Chat → Default chat mode`，您可以將其設定為您偏好的特定模式，或設定為「最近使用的模式」。